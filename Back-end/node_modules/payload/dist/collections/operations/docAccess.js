"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "docAccess", {
    enumerable: true,
    get: function() {
        return docAccess;
    }
});
const _getEntityPolicies = require("../../utilities/getEntityPolicies");
const allOperations = [
    'create',
    'read',
    'update',
    'delete'
];
async function docAccess(args) {
    const { id, req, req: { collection: { config } } } = args;
    const collectionOperations = [
        ...allOperations
    ];
    if (config.auth && typeof config.auth.maxLoginAttempts !== 'undefined' && config.auth.maxLoginAttempts !== 0) {
        collectionOperations.push('unlock');
    }
    if (config.versions) {
        collectionOperations.push('readVersions');
    }
    return (0, _getEntityPolicies.getEntityPolicies)({
        id,
        entity: config,
        operations: collectionOperations,
        req,
        type: 'collection'
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb2xsZWN0aW9ucy9vcGVyYXRpb25zL2RvY0FjY2Vzcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IENvbGxlY3Rpb25QZXJtaXNzaW9uIH0gZnJvbSAnLi4vLi4vYXV0aCdcbmltcG9ydCB0eXBlIHsgUGF5bG9hZFJlcXVlc3QgfSBmcm9tICcuLi8uLi9leHByZXNzL3R5cGVzJ1xuaW1wb3J0IHR5cGUgeyBBbGxPcGVyYXRpb25zIH0gZnJvbSAnLi4vLi4vdHlwZXMnXG5cbmltcG9ydCB7IGdldEVudGl0eVBvbGljaWVzIH0gZnJvbSAnLi4vLi4vdXRpbGl0aWVzL2dldEVudGl0eVBvbGljaWVzJ1xuXG5jb25zdCBhbGxPcGVyYXRpb25zOiBBbGxPcGVyYXRpb25zW10gPSBbJ2NyZWF0ZScsICdyZWFkJywgJ3VwZGF0ZScsICdkZWxldGUnXVxuXG50eXBlIEFyZ3VtZW50cyA9IHtcbiAgaWQ6IHN0cmluZ1xuICByZXE6IFBheWxvYWRSZXF1ZXN0XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkb2NBY2Nlc3MoYXJnczogQXJndW1lbnRzKTogUHJvbWlzZTxDb2xsZWN0aW9uUGVybWlzc2lvbj4ge1xuICBjb25zdCB7XG4gICAgaWQsXG4gICAgcmVxLFxuICAgIHJlcToge1xuICAgICAgY29sbGVjdGlvbjogeyBjb25maWcgfSxcbiAgICB9LFxuICB9ID0gYXJnc1xuXG4gIGNvbnN0IGNvbGxlY3Rpb25PcGVyYXRpb25zID0gWy4uLmFsbE9wZXJhdGlvbnNdXG5cbiAgaWYgKFxuICAgIGNvbmZpZy5hdXRoICYmXG4gICAgdHlwZW9mIGNvbmZpZy5hdXRoLm1heExvZ2luQXR0ZW1wdHMgIT09ICd1bmRlZmluZWQnICYmXG4gICAgY29uZmlnLmF1dGgubWF4TG9naW5BdHRlbXB0cyAhPT0gMFxuICApIHtcbiAgICBjb2xsZWN0aW9uT3BlcmF0aW9ucy5wdXNoKCd1bmxvY2snKVxuICB9XG5cbiAgaWYgKGNvbmZpZy52ZXJzaW9ucykge1xuICAgIGNvbGxlY3Rpb25PcGVyYXRpb25zLnB1c2goJ3JlYWRWZXJzaW9ucycpXG4gIH1cblxuICByZXR1cm4gZ2V0RW50aXR5UG9saWNpZXMoe1xuICAgIGlkLFxuICAgIGVudGl0eTogY29uZmlnLFxuICAgIG9wZXJhdGlvbnM6IGNvbGxlY3Rpb25PcGVyYXRpb25zLFxuICAgIHJlcSxcbiAgICB0eXBlOiAnY29sbGVjdGlvbicsXG4gIH0pXG59XG4iXSwibmFtZXMiOlsiZG9jQWNjZXNzIiwiYWxsT3BlcmF0aW9ucyIsImFyZ3MiLCJpZCIsInJlcSIsImNvbGxlY3Rpb24iLCJjb25maWciLCJjb2xsZWN0aW9uT3BlcmF0aW9ucyIsImF1dGgiLCJtYXhMb2dpbkF0dGVtcHRzIiwicHVzaCIsInZlcnNpb25zIiwiZ2V0RW50aXR5UG9saWNpZXMiLCJlbnRpdHkiLCJvcGVyYXRpb25zIiwidHlwZSJdLCJtYXBwaW5ncyI6Ijs7OzsrQkFhc0JBOzs7ZUFBQUE7OzttQ0FUWTtBQUVsQyxNQUFNQyxnQkFBaUM7SUFBQztJQUFVO0lBQVE7SUFBVTtDQUFTO0FBT3RFLGVBQWVELFVBQVVFLElBQWU7SUFDN0MsTUFBTSxFQUNKQyxFQUFFLEVBQ0ZDLEdBQUcsRUFDSEEsS0FBSyxFQUNIQyxZQUFZLEVBQUVDLE1BQU0sRUFBRSxFQUN2QixFQUNGLEdBQUdKO0lBRUosTUFBTUssdUJBQXVCO1dBQUlOO0tBQWM7SUFFL0MsSUFDRUssT0FBT0UsSUFBSSxJQUNYLE9BQU9GLE9BQU9FLElBQUksQ0FBQ0MsZ0JBQWdCLEtBQUssZUFDeENILE9BQU9FLElBQUksQ0FBQ0MsZ0JBQWdCLEtBQUssR0FDakM7UUFDQUYscUJBQXFCRyxJQUFJLENBQUM7SUFDNUI7SUFFQSxJQUFJSixPQUFPSyxRQUFRLEVBQUU7UUFDbkJKLHFCQUFxQkcsSUFBSSxDQUFDO0lBQzVCO0lBRUEsT0FBT0UsSUFBQUEsb0NBQWlCLEVBQUM7UUFDdkJUO1FBQ0FVLFFBQVFQO1FBQ1JRLFlBQVlQO1FBQ1pIO1FBQ0FXLE1BQU07SUFDUjtBQUNGIn0=