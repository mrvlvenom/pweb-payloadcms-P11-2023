"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "readMigrationFiles", {
    enumerable: true,
    get: function() {
        return readMigrationFiles;
    }
});
const _fs = /*#__PURE__*/ _interop_require_default(require("fs"));
const _path = /*#__PURE__*/ _interop_require_default(require("path"));
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
const readMigrationFiles = async ({ payload })=>{
    if (!_fs.default.existsSync(payload.db.migrationDir)) {
        payload.logger.debug({
            msg: `No migration directory found at ${payload.db.migrationDir}`
        });
        return [];
    }
    const files = _fs.default.readdirSync(payload.db.migrationDir).sort().filter((f)=>f.endsWith('.ts')).map((file)=>{
        return _path.default.resolve(payload.db.migrationDir, file);
    });
    return files.map((filePath)=>{
        // eslint-disable-next-line @typescript-eslint/no-var-requires,import/no-dynamic-require
        const migration = require(filePath);
        migration.name = _path.default.basename(filePath).split('.')?.[0];
        return migration;
    });
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9kYXRhYmFzZS9taWdyYXRpb25zL3JlYWRNaWdyYXRpb25GaWxlcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZnMgZnJvbSAnZnMnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuXG5pbXBvcnQgdHlwZSB7IFBheWxvYWQgfSBmcm9tICcuLi8uLi8nXG5pbXBvcnQgdHlwZSB7IE1pZ3JhdGlvbiB9IGZyb20gJy4uL3R5cGVzJ1xuXG4vKipcbiAqIFJlYWQgdGhlIG1pZ3JhdGlvbiBmaWxlcyBmcm9tIGRpc2tcbiAqL1xuZXhwb3J0IGNvbnN0IHJlYWRNaWdyYXRpb25GaWxlcyA9IGFzeW5jICh7XG4gIHBheWxvYWQsXG59OiB7XG4gIHBheWxvYWQ6IFBheWxvYWRcbn0pOiBQcm9taXNlPE1pZ3JhdGlvbltdPiA9PiB7XG4gIGlmICghZnMuZXhpc3RzU3luYyhwYXlsb2FkLmRiLm1pZ3JhdGlvbkRpcikpIHtcbiAgICBwYXlsb2FkLmxvZ2dlci5kZWJ1Zyh7XG4gICAgICBtc2c6IGBObyBtaWdyYXRpb24gZGlyZWN0b3J5IGZvdW5kIGF0ICR7cGF5bG9hZC5kYi5taWdyYXRpb25EaXJ9YCxcbiAgICB9KVxuICAgIHJldHVybiBbXVxuICB9XG5cbiAgY29uc3QgZmlsZXMgPSBmc1xuICAgIC5yZWFkZGlyU3luYyhwYXlsb2FkLmRiLm1pZ3JhdGlvbkRpcilcbiAgICAuc29ydCgpXG4gICAgLmZpbHRlcigoZikgPT4gZi5lbmRzV2l0aCgnLnRzJykpXG4gICAgLm1hcCgoZmlsZSkgPT4ge1xuICAgICAgcmV0dXJuIHBhdGgucmVzb2x2ZShwYXlsb2FkLmRiLm1pZ3JhdGlvbkRpciwgZmlsZSlcbiAgICB9KVxuXG4gIHJldHVybiBmaWxlcy5tYXAoKGZpbGVQYXRoKSA9PiB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby12YXItcmVxdWlyZXMsaW1wb3J0L25vLWR5bmFtaWMtcmVxdWlyZVxuICAgIGNvbnN0IG1pZ3JhdGlvbiA9IHJlcXVpcmUoZmlsZVBhdGgpIGFzIE1pZ3JhdGlvblxuICAgIG1pZ3JhdGlvbi5uYW1lID0gcGF0aC5iYXNlbmFtZShmaWxlUGF0aCkuc3BsaXQoJy4nKT8uWzBdXG4gICAgcmV0dXJuIG1pZ3JhdGlvblxuICB9KVxufVxuIl0sIm5hbWVzIjpbInJlYWRNaWdyYXRpb25GaWxlcyIsInBheWxvYWQiLCJmcyIsImV4aXN0c1N5bmMiLCJkYiIsIm1pZ3JhdGlvbkRpciIsImxvZ2dlciIsImRlYnVnIiwibXNnIiwiZmlsZXMiLCJyZWFkZGlyU3luYyIsInNvcnQiLCJmaWx0ZXIiLCJmIiwiZW5kc1dpdGgiLCJtYXAiLCJmaWxlIiwicGF0aCIsInJlc29sdmUiLCJmaWxlUGF0aCIsIm1pZ3JhdGlvbiIsInJlcXVpcmUiLCJuYW1lIiwiYmFzZW5hbWUiLCJzcGxpdCJdLCJtYXBwaW5ncyI6Ijs7OzsrQkFTYUE7OztlQUFBQTs7OzJEQVRFOzZEQUNFOzs7Ozs7QUFRVixNQUFNQSxxQkFBcUIsT0FBTyxFQUN2Q0MsT0FBTyxFQUdSO0lBQ0MsSUFBSSxDQUFDQyxXQUFFLENBQUNDLFVBQVUsQ0FBQ0YsUUFBUUcsRUFBRSxDQUFDQyxZQUFZLEdBQUc7UUFDM0NKLFFBQVFLLE1BQU0sQ0FBQ0MsS0FBSyxDQUFDO1lBQ25CQyxLQUFLLENBQUMsZ0NBQWdDLEVBQUVQLFFBQVFHLEVBQUUsQ0FBQ0MsWUFBWSxDQUFDLENBQUM7UUFDbkU7UUFDQSxPQUFPLEVBQUU7SUFDWDtJQUVBLE1BQU1JLFFBQVFQLFdBQUUsQ0FDYlEsV0FBVyxDQUFDVCxRQUFRRyxFQUFFLENBQUNDLFlBQVksRUFDbkNNLElBQUksR0FDSkMsTUFBTSxDQUFDLENBQUNDLElBQU1BLEVBQUVDLFFBQVEsQ0FBQyxRQUN6QkMsR0FBRyxDQUFDLENBQUNDO1FBQ0osT0FBT0MsYUFBSSxDQUFDQyxPQUFPLENBQUNqQixRQUFRRyxFQUFFLENBQUNDLFlBQVksRUFBRVc7SUFDL0M7SUFFRixPQUFPUCxNQUFNTSxHQUFHLENBQUMsQ0FBQ0k7UUFDaEIsd0ZBQXdGO1FBQ3hGLE1BQU1DLFlBQVlDLFFBQVFGO1FBQzFCQyxVQUFVRSxJQUFJLEdBQUdMLGFBQUksQ0FBQ00sUUFBUSxDQUFDSixVQUFVSyxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQUU7UUFDeEQsT0FBT0o7SUFDVDtBQUNGIn0=