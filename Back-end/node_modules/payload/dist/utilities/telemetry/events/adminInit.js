"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "adminInit", {
    enumerable: true,
    get: function() {
        return adminInit;
    }
});
const _ = require("..");
const _oneWayHash = require("../oneWayHash");
const adminInit = (req)=>{
    const { payload, user } = req;
    const { host } = req.headers;
    let domainID;
    let userID;
    if (host) {
        domainID = (0, _oneWayHash.oneWayHash)(host, payload.secret);
    }
    if (user && typeof user?.id === 'string') {
        userID = (0, _oneWayHash.oneWayHash)(user.id, payload.secret);
    }
    // eslint-disable-next-line @typescript-eslint/no-floating-promises
    (0, _.sendEvent)({
        event: {
            domainID,
            type: 'admin-init',
            userID
        },
        payload
    });
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy91dGlsaXRpZXMvdGVsZW1ldHJ5L2V2ZW50cy9hZG1pbkluaXQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBQYXlsb2FkUmVxdWVzdCB9IGZyb20gJy4uLy4uLy4uL2V4cHJlc3MvdHlwZXMnXG5cbmltcG9ydCB7IHNlbmRFdmVudCB9IGZyb20gJy4uJ1xuaW1wb3J0IHsgb25lV2F5SGFzaCB9IGZyb20gJy4uL29uZVdheUhhc2gnXG5cbmV4cG9ydCB0eXBlIEFkbWluSW5pdEV2ZW50ID0ge1xuICBkb21haW5JRD86IHN0cmluZ1xuICB0eXBlOiAnYWRtaW4taW5pdCdcbiAgdXNlcklEPzogc3RyaW5nXG59XG5cbmV4cG9ydCBjb25zdCBhZG1pbkluaXQgPSAocmVxOiBQYXlsb2FkUmVxdWVzdCk6IHZvaWQgPT4ge1xuICBjb25zdCB7IHBheWxvYWQsIHVzZXIgfSA9IHJlcVxuICBjb25zdCB7IGhvc3QgfSA9IHJlcS5oZWFkZXJzXG5cbiAgbGV0IGRvbWFpbklEOiBzdHJpbmdcbiAgbGV0IHVzZXJJRDogc3RyaW5nXG5cbiAgaWYgKGhvc3QpIHtcbiAgICBkb21haW5JRCA9IG9uZVdheUhhc2goaG9zdCwgcGF5bG9hZC5zZWNyZXQpXG4gIH1cblxuICBpZiAodXNlciAmJiB0eXBlb2YgdXNlcj8uaWQgPT09ICdzdHJpbmcnKSB7XG4gICAgdXNlcklEID0gb25lV2F5SGFzaCh1c2VyLmlkLCBwYXlsb2FkLnNlY3JldClcbiAgfVxuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgc2VuZEV2ZW50KHtcbiAgICBldmVudDoge1xuICAgICAgZG9tYWluSUQsXG4gICAgICB0eXBlOiAnYWRtaW4taW5pdCcsXG4gICAgICB1c2VySUQsXG4gICAgfSxcbiAgICBwYXlsb2FkLFxuICB9KVxufVxuIl0sIm5hbWVzIjpbImFkbWluSW5pdCIsInJlcSIsInBheWxvYWQiLCJ1c2VyIiwiaG9zdCIsImhlYWRlcnMiLCJkb21haW5JRCIsInVzZXJJRCIsIm9uZVdheUhhc2giLCJzZWNyZXQiLCJpZCIsInNlbmRFdmVudCIsImV2ZW50IiwidHlwZSJdLCJtYXBwaW5ncyI6Ijs7OzsrQkFXYUE7OztlQUFBQTs7O2tCQVRhOzRCQUNDO0FBUXBCLE1BQU1BLFlBQVksQ0FBQ0M7SUFDeEIsTUFBTSxFQUFFQyxPQUFPLEVBQUVDLElBQUksRUFBRSxHQUFHRjtJQUMxQixNQUFNLEVBQUVHLElBQUksRUFBRSxHQUFHSCxJQUFJSSxPQUFPO0lBRTVCLElBQUlDO0lBQ0osSUFBSUM7SUFFSixJQUFJSCxNQUFNO1FBQ1JFLFdBQVdFLElBQUFBLHNCQUFVLEVBQUNKLE1BQU1GLFFBQVFPLE1BQU07SUFDNUM7SUFFQSxJQUFJTixRQUFRLE9BQU9BLE1BQU1PLE9BQU8sVUFBVTtRQUN4Q0gsU0FBU0MsSUFBQUEsc0JBQVUsRUFBQ0wsS0FBS08sRUFBRSxFQUFFUixRQUFRTyxNQUFNO0lBQzdDO0lBRUEsbUVBQW1FO0lBQ25FRSxJQUFBQSxXQUFTLEVBQUM7UUFDUkMsT0FBTztZQUNMTjtZQUNBTyxNQUFNO1lBQ05OO1FBQ0Y7UUFDQUw7SUFDRjtBQUNGIn0=