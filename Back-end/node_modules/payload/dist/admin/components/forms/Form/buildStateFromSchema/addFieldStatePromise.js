/* eslint-disable no-param-reassign */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "addFieldStatePromise", {
    enumerable: true,
    get: function() {
        return addFieldStatePromise;
    }
});
const _bsonobjectid = /*#__PURE__*/ _interop_require_default(require("bson-objectid"));
const _types = require("../../../../../fields/config/types");
const _getDefaultValue = /*#__PURE__*/ _interop_require_default(require("../../../../../fields/getDefaultValue"));
const _iterateFields = require("./iterateFields");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
const addFieldStatePromise = async ({ id, config, data, field, fullData, locale, operation, passesCondition, path, preferences, state, t, user })=>{
    if ((0, _types.fieldAffectsData)(field)) {
        const fieldState = {
            condition: field.admin?.condition,
            initialValue: undefined,
            passesCondition,
            valid: true,
            validate: field.validate,
            value: undefined
        };
        const valueWithDefault = await (0, _getDefaultValue.default)({
            defaultValue: field.defaultValue,
            locale,
            user,
            value: data?.[field.name]
        });
        if (data?.[field.name]) {
            data[field.name] = valueWithDefault;
        }
        let validationResult = true;
        if (typeof fieldState.validate === 'function') {
            validationResult = await fieldState.validate(data?.[field.name], {
                ...field,
                id,
                config,
                data: fullData,
                operation,
                siblingData: data,
                t,
                user
            });
        }
        if (typeof validationResult === 'string') {
            fieldState.errorMessage = validationResult;
            fieldState.valid = false;
        } else {
            fieldState.valid = true;
        }
        switch(field.type){
            case 'array':
                {
                    const arrayValue = Array.isArray(valueWithDefault) ? valueWithDefault : [];
                    const { promises, rowMetadata } = arrayValue.reduce((acc, row, i)=>{
                        const rowPath = `${path}${field.name}.${i}.`;
                        row.id = row?.id || new _bsonobjectid.default().toHexString();
                        state[`${rowPath}id`] = {
                            initialValue: row.id,
                            valid: true,
                            value: row.id
                        };
                        acc.promises.push((0, _iterateFields.iterateFields)({
                            id,
                            config,
                            data: row,
                            fields: field.fields,
                            fullData,
                            locale,
                            operation,
                            parentPassesCondition: passesCondition,
                            path: rowPath,
                            preferences,
                            state,
                            t,
                            user
                        }));
                        const collapsedRowIDs = preferences?.fields?.[`${path}${field.name}`]?.collapsed;
                        acc.rowMetadata.push({
                            id: row.id,
                            childErrorPaths: new Set(),
                            collapsed: collapsedRowIDs === undefined ? field.admin.initCollapsed : collapsedRowIDs.includes(row.id)
                        });
                        return acc;
                    }, {
                        promises: [],
                        rowMetadata: []
                    });
                    await Promise.all(promises);
                    // Add values to field state
                    if (valueWithDefault === null) {
                        fieldState.value = null;
                        fieldState.initialValue = null;
                    } else {
                        fieldState.value = arrayValue.length;
                        fieldState.initialValue = arrayValue.length;
                        if (arrayValue.length > 0) {
                            fieldState.disableFormData = true;
                        }
                    }
                    fieldState.rows = rowMetadata;
                    // Add field to state
                    state[`${path}${field.name}`] = fieldState;
                    break;
                }
            case 'blocks':
                {
                    const blocksValue = Array.isArray(valueWithDefault) ? valueWithDefault : [];
                    const { promises, rowMetadata } = blocksValue.reduce((acc, row, i)=>{
                        const block = field.blocks.find((blockType)=>blockType.slug === row.blockType);
                        const rowPath = `${path}${field.name}.${i}.`;
                        if (block) {
                            row.id = row?.id || new _bsonobjectid.default().toHexString();
                            state[`${rowPath}id`] = {
                                initialValue: row.id,
                                valid: true,
                                value: row.id
                            };
                            state[`${rowPath}blockType`] = {
                                initialValue: row.blockType,
                                valid: true,
                                value: row.blockType
                            };
                            state[`${rowPath}blockName`] = {
                                initialValue: row.blockName,
                                valid: true,
                                value: row.blockName
                            };
                            acc.promises.push((0, _iterateFields.iterateFields)({
                                id,
                                config,
                                data: row,
                                fields: block.fields,
                                fullData,
                                locale,
                                operation,
                                parentPassesCondition: passesCondition,
                                path: rowPath,
                                preferences,
                                state,
                                t,
                                user
                            }));
                            const collapsedRowIDs = preferences?.fields?.[`${path}${field.name}`]?.collapsed;
                            acc.rowMetadata.push({
                                id: row.id,
                                blockType: row.blockType,
                                childErrorPaths: new Set(),
                                collapsed: collapsedRowIDs === undefined ? field.admin.initCollapsed : collapsedRowIDs.includes(row.id)
                            });
                        }
                        return acc;
                    }, {
                        promises: [],
                        rowMetadata: []
                    });
                    await Promise.all(promises);
                    // Add values to field state
                    if (valueWithDefault === null) {
                        fieldState.value = null;
                        fieldState.initialValue = null;
                    } else {
                        fieldState.value = blocksValue.length;
                        fieldState.initialValue = blocksValue.length;
                        if (blocksValue.length > 0) {
                            fieldState.disableFormData = true;
                        }
                    }
                    fieldState.rows = rowMetadata;
                    // Add field to state
                    state[`${path}${field.name}`] = fieldState;
                    break;
                }
            case 'group':
                {
                    await (0, _iterateFields.iterateFields)({
                        id,
                        config,
                        data: data?.[field.name] || {},
                        fields: field.fields,
                        fullData,
                        locale,
                        operation,
                        parentPassesCondition: passesCondition,
                        path: `${path}${field.name}.`,
                        preferences,
                        state,
                        t,
                        user
                    });
                    break;
                }
            case 'relationship':
                {
                    if (field.hasMany) {
                        const relationshipValue = Array.isArray(valueWithDefault) ? valueWithDefault.map((relationship)=>{
                            if (Array.isArray(field.relationTo)) {
                                return {
                                    relationTo: relationship.relationTo,
                                    value: typeof relationship.value === 'string' ? relationship.value : relationship.value?.id
                                };
                            }
                            if (typeof relationship === 'object' && relationship !== null) {
                                return relationship.id;
                            }
                            return relationship;
                        }) : undefined;
                        fieldState.value = relationshipValue;
                        fieldState.initialValue = relationshipValue;
                    } else if (Array.isArray(field.relationTo)) {
                        if (valueWithDefault && typeof valueWithDefault === 'object' && 'relationTo' in valueWithDefault && 'value' in valueWithDefault) {
                            const value = typeof valueWithDefault?.value === 'object' && valueWithDefault?.value && 'id' in valueWithDefault.value ? valueWithDefault.value.id : valueWithDefault.value;
                            const relationshipValue = {
                                relationTo: valueWithDefault?.relationTo,
                                value
                            };
                            fieldState.value = relationshipValue;
                            fieldState.initialValue = relationshipValue;
                        }
                    } else {
                        const relationshipValue = valueWithDefault && typeof valueWithDefault === 'object' && 'id' in valueWithDefault ? valueWithDefault.id : valueWithDefault;
                        fieldState.value = relationshipValue;
                        fieldState.initialValue = relationshipValue;
                    }
                    state[`${path}${field.name}`] = fieldState;
                    break;
                }
            case 'upload':
                {
                    const relationshipValue = valueWithDefault && typeof valueWithDefault === 'object' && 'id' in valueWithDefault ? valueWithDefault.id : valueWithDefault;
                    fieldState.value = relationshipValue;
                    fieldState.initialValue = relationshipValue;
                    state[`${path}${field.name}`] = fieldState;
                    break;
                }
            default:
                {
                    fieldState.value = valueWithDefault;
                    fieldState.initialValue = valueWithDefault;
                    // Add field to state
                    state[`${path}${field.name}`] = fieldState;
                    break;
                }
        }
    } else if ((0, _types.fieldHasSubFields)(field)) {
        // Handle field types that do not use names (row, etc)
        await (0, _iterateFields.iterateFields)({
            id,
            config,
            data,
            fields: field.fields,
            fullData,
            locale,
            operation,
            parentPassesCondition: passesCondition,
            path,
            preferences,
            state,
            t,
            user
        });
    } else if (field.type === 'tabs') {
        const promises = field.tabs.map((tab)=>(0, _iterateFields.iterateFields)({
                id,
                config,
                data: (0, _types.tabHasName)(tab) ? data?.[tab.name] : data,
                fields: tab.fields,
                fullData,
                locale,
                operation,
                parentPassesCondition: passesCondition,
                path: (0, _types.tabHasName)(tab) ? `${path}${tab.name}.` : path,
                preferences,
                state,
                t,
                user
            }));
        await Promise.all(promises);
    }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9hZG1pbi9jb21wb25lbnRzL2Zvcm1zL0Zvcm0vYnVpbGRTdGF0ZUZyb21TY2hlbWEvYWRkRmllbGRTdGF0ZVByb21pc2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgbm8tcGFyYW0tcmVhc3NpZ24gKi9cbmltcG9ydCB0eXBlIHsgVEZ1bmN0aW9uIH0gZnJvbSAnaTE4bmV4dCdcblxuaW1wb3J0IE9iamVjdElEIGZyb20gJ2Jzb24tb2JqZWN0aWQnXG5cbmltcG9ydCB0eXBlIHsgVXNlciB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL2F1dGgnXG5pbXBvcnQgdHlwZSB7IFNhbml0aXplZENvbmZpZyB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL2NvbmZpZy90eXBlcydcbmltcG9ydCB0eXBlIHsgTm9uUHJlc2VudGF0aW9uYWxGaWVsZCB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL2ZpZWxkcy9jb25maWcvdHlwZXMnXG5pbXBvcnQgdHlwZSB7IERhdGEsIEZpZWxkcywgRm9ybUZpZWxkIH0gZnJvbSAnLi4vdHlwZXMnXG5cbmltcG9ydCB7IGZpZWxkQWZmZWN0c0RhdGEsIGZpZWxkSGFzU3ViRmllbGRzLCB0YWJIYXNOYW1lIH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vZmllbGRzL2NvbmZpZy90eXBlcydcbmltcG9ydCBnZXRWYWx1ZVdpdGhEZWZhdWx0IGZyb20gJy4uLy4uLy4uLy4uLy4uL2ZpZWxkcy9nZXREZWZhdWx0VmFsdWUnXG5pbXBvcnQgeyBpdGVyYXRlRmllbGRzIH0gZnJvbSAnLi9pdGVyYXRlRmllbGRzJ1xuXG50eXBlIEFyZ3MgPSB7XG4gIGNvbmZpZzogU2FuaXRpemVkQ29uZmlnXG4gIGRhdGE6IERhdGFcbiAgZmllbGQ6IE5vblByZXNlbnRhdGlvbmFsRmllbGRcbiAgZnVsbERhdGE6IERhdGFcbiAgaWQ6IG51bWJlciB8IHN0cmluZ1xuICBsb2NhbGU6IHN0cmluZ1xuICBvcGVyYXRpb246ICdjcmVhdGUnIHwgJ3VwZGF0ZSdcbiAgcGFzc2VzQ29uZGl0aW9uOiBib29sZWFuXG4gIHBhdGg6IHN0cmluZ1xuICBwcmVmZXJlbmNlczoge1xuICAgIFtrZXk6IHN0cmluZ106IHVua25vd25cbiAgfVxuICBzdGF0ZTogRmllbGRzXG4gIHQ6IFRGdW5jdGlvblxuICB1c2VyOiBVc2VyXG59XG5cbmV4cG9ydCBjb25zdCBhZGRGaWVsZFN0YXRlUHJvbWlzZSA9IGFzeW5jICh7XG4gIGlkLFxuICBjb25maWcsXG4gIGRhdGEsXG4gIGZpZWxkLFxuICBmdWxsRGF0YSxcbiAgbG9jYWxlLFxuICBvcGVyYXRpb24sXG4gIHBhc3Nlc0NvbmRpdGlvbixcbiAgcGF0aCxcbiAgcHJlZmVyZW5jZXMsXG4gIHN0YXRlLFxuICB0LFxuICB1c2VyLFxufTogQXJncyk6IFByb21pc2U8dm9pZD4gPT4ge1xuICBpZiAoZmllbGRBZmZlY3RzRGF0YShmaWVsZCkpIHtcbiAgICBjb25zdCBmaWVsZFN0YXRlOiBGb3JtRmllbGQgPSB7XG4gICAgICBjb25kaXRpb246IGZpZWxkLmFkbWluPy5jb25kaXRpb24sXG4gICAgICBpbml0aWFsVmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgIHBhc3Nlc0NvbmRpdGlvbixcbiAgICAgIHZhbGlkOiB0cnVlLFxuICAgICAgdmFsaWRhdGU6IGZpZWxkLnZhbGlkYXRlLFxuICAgICAgdmFsdWU6IHVuZGVmaW5lZCxcbiAgICB9XG5cbiAgICBjb25zdCB2YWx1ZVdpdGhEZWZhdWx0ID0gYXdhaXQgZ2V0VmFsdWVXaXRoRGVmYXVsdCh7XG4gICAgICBkZWZhdWx0VmFsdWU6IGZpZWxkLmRlZmF1bHRWYWx1ZSxcbiAgICAgIGxvY2FsZSxcbiAgICAgIHVzZXIsXG4gICAgICB2YWx1ZTogZGF0YT8uW2ZpZWxkLm5hbWVdLFxuICAgIH0pXG5cbiAgICBpZiAoZGF0YT8uW2ZpZWxkLm5hbWVdKSB7XG4gICAgICBkYXRhW2ZpZWxkLm5hbWVdID0gdmFsdWVXaXRoRGVmYXVsdFxuICAgIH1cblxuICAgIGxldCB2YWxpZGF0aW9uUmVzdWx0OiBib29sZWFuIHwgc3RyaW5nID0gdHJ1ZVxuXG4gICAgaWYgKHR5cGVvZiBmaWVsZFN0YXRlLnZhbGlkYXRlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICB2YWxpZGF0aW9uUmVzdWx0ID0gYXdhaXQgZmllbGRTdGF0ZS52YWxpZGF0ZShkYXRhPy5bZmllbGQubmFtZV0sIHtcbiAgICAgICAgLi4uZmllbGQsXG4gICAgICAgIGlkLFxuICAgICAgICBjb25maWcsXG4gICAgICAgIGRhdGE6IGZ1bGxEYXRhLFxuICAgICAgICBvcGVyYXRpb24sXG4gICAgICAgIHNpYmxpbmdEYXRhOiBkYXRhLFxuICAgICAgICB0LFxuICAgICAgICB1c2VyLFxuICAgICAgfSlcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIHZhbGlkYXRpb25SZXN1bHQgPT09ICdzdHJpbmcnKSB7XG4gICAgICBmaWVsZFN0YXRlLmVycm9yTWVzc2FnZSA9IHZhbGlkYXRpb25SZXN1bHRcbiAgICAgIGZpZWxkU3RhdGUudmFsaWQgPSBmYWxzZVxuICAgIH0gZWxzZSB7XG4gICAgICBmaWVsZFN0YXRlLnZhbGlkID0gdHJ1ZVxuICAgIH1cblxuICAgIHN3aXRjaCAoZmllbGQudHlwZSkge1xuICAgICAgY2FzZSAnYXJyYXknOiB7XG4gICAgICAgIGNvbnN0IGFycmF5VmFsdWUgPSBBcnJheS5pc0FycmF5KHZhbHVlV2l0aERlZmF1bHQpID8gdmFsdWVXaXRoRGVmYXVsdCA6IFtdXG4gICAgICAgIGNvbnN0IHsgcHJvbWlzZXMsIHJvd01ldGFkYXRhIH0gPSBhcnJheVZhbHVlLnJlZHVjZShcbiAgICAgICAgICAoYWNjLCByb3csIGkpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJvd1BhdGggPSBgJHtwYXRofSR7ZmllbGQubmFtZX0uJHtpfS5gXG4gICAgICAgICAgICByb3cuaWQgPSByb3c/LmlkIHx8IG5ldyBPYmplY3RJRCgpLnRvSGV4U3RyaW5nKClcblxuICAgICAgICAgICAgc3RhdGVbYCR7cm93UGF0aH1pZGBdID0ge1xuICAgICAgICAgICAgICBpbml0aWFsVmFsdWU6IHJvdy5pZCxcbiAgICAgICAgICAgICAgdmFsaWQ6IHRydWUsXG4gICAgICAgICAgICAgIHZhbHVlOiByb3cuaWQsXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGFjYy5wcm9taXNlcy5wdXNoKFxuICAgICAgICAgICAgICBpdGVyYXRlRmllbGRzKHtcbiAgICAgICAgICAgICAgICBpZCxcbiAgICAgICAgICAgICAgICBjb25maWcsXG4gICAgICAgICAgICAgICAgZGF0YTogcm93LFxuICAgICAgICAgICAgICAgIGZpZWxkczogZmllbGQuZmllbGRzLFxuICAgICAgICAgICAgICAgIGZ1bGxEYXRhLFxuICAgICAgICAgICAgICAgIGxvY2FsZSxcbiAgICAgICAgICAgICAgICBvcGVyYXRpb24sXG4gICAgICAgICAgICAgICAgcGFyZW50UGFzc2VzQ29uZGl0aW9uOiBwYXNzZXNDb25kaXRpb24sXG4gICAgICAgICAgICAgICAgcGF0aDogcm93UGF0aCxcbiAgICAgICAgICAgICAgICBwcmVmZXJlbmNlcyxcbiAgICAgICAgICAgICAgICBzdGF0ZSxcbiAgICAgICAgICAgICAgICB0LFxuICAgICAgICAgICAgICAgIHVzZXIsXG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgKVxuXG4gICAgICAgICAgICBjb25zdCBjb2xsYXBzZWRSb3dJRHMgPSBwcmVmZXJlbmNlcz8uZmllbGRzPy5bYCR7cGF0aH0ke2ZpZWxkLm5hbWV9YF0/LmNvbGxhcHNlZFxuXG4gICAgICAgICAgICBhY2Mucm93TWV0YWRhdGEucHVzaCh7XG4gICAgICAgICAgICAgIGlkOiByb3cuaWQsXG4gICAgICAgICAgICAgIGNoaWxkRXJyb3JQYXRoczogbmV3IFNldCgpLFxuICAgICAgICAgICAgICBjb2xsYXBzZWQ6XG4gICAgICAgICAgICAgICAgY29sbGFwc2VkUm93SURzID09PSB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgID8gZmllbGQuYWRtaW4uaW5pdENvbGxhcHNlZFxuICAgICAgICAgICAgICAgICAgOiBjb2xsYXBzZWRSb3dJRHMuaW5jbHVkZXMocm93LmlkKSxcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIHJldHVybiBhY2NcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHByb21pc2VzOiBbXSxcbiAgICAgICAgICAgIHJvd01ldGFkYXRhOiBbXSxcbiAgICAgICAgICB9LFxuICAgICAgICApXG5cbiAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpXG5cbiAgICAgICAgLy8gQWRkIHZhbHVlcyB0byBmaWVsZCBzdGF0ZVxuICAgICAgICBpZiAodmFsdWVXaXRoRGVmYXVsdCA9PT0gbnVsbCkge1xuICAgICAgICAgIGZpZWxkU3RhdGUudmFsdWUgPSBudWxsXG4gICAgICAgICAgZmllbGRTdGF0ZS5pbml0aWFsVmFsdWUgPSBudWxsXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZmllbGRTdGF0ZS52YWx1ZSA9IGFycmF5VmFsdWUubGVuZ3RoXG4gICAgICAgICAgZmllbGRTdGF0ZS5pbml0aWFsVmFsdWUgPSBhcnJheVZhbHVlLmxlbmd0aFxuXG4gICAgICAgICAgaWYgKGFycmF5VmFsdWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZmllbGRTdGF0ZS5kaXNhYmxlRm9ybURhdGEgPSB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZmllbGRTdGF0ZS5yb3dzID0gcm93TWV0YWRhdGFcblxuICAgICAgICAvLyBBZGQgZmllbGQgdG8gc3RhdGVcbiAgICAgICAgc3RhdGVbYCR7cGF0aH0ke2ZpZWxkLm5hbWV9YF0gPSBmaWVsZFN0YXRlXG5cbiAgICAgICAgYnJlYWtcbiAgICAgIH1cblxuICAgICAgY2FzZSAnYmxvY2tzJzoge1xuICAgICAgICBjb25zdCBibG9ja3NWYWx1ZSA9IEFycmF5LmlzQXJyYXkodmFsdWVXaXRoRGVmYXVsdCkgPyB2YWx1ZVdpdGhEZWZhdWx0IDogW11cblxuICAgICAgICBjb25zdCB7IHByb21pc2VzLCByb3dNZXRhZGF0YSB9ID0gYmxvY2tzVmFsdWUucmVkdWNlKFxuICAgICAgICAgIChhY2MsIHJvdywgaSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgYmxvY2sgPSBmaWVsZC5ibG9ja3MuZmluZCgoYmxvY2tUeXBlKSA9PiBibG9ja1R5cGUuc2x1ZyA9PT0gcm93LmJsb2NrVHlwZSlcbiAgICAgICAgICAgIGNvbnN0IHJvd1BhdGggPSBgJHtwYXRofSR7ZmllbGQubmFtZX0uJHtpfS5gXG5cbiAgICAgICAgICAgIGlmIChibG9jaykge1xuICAgICAgICAgICAgICByb3cuaWQgPSByb3c/LmlkIHx8IG5ldyBPYmplY3RJRCgpLnRvSGV4U3RyaW5nKClcblxuICAgICAgICAgICAgICBzdGF0ZVtgJHtyb3dQYXRofWlkYF0gPSB7XG4gICAgICAgICAgICAgICAgaW5pdGlhbFZhbHVlOiByb3cuaWQsXG4gICAgICAgICAgICAgICAgdmFsaWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHJvdy5pZCxcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHN0YXRlW2Ake3Jvd1BhdGh9YmxvY2tUeXBlYF0gPSB7XG4gICAgICAgICAgICAgICAgaW5pdGlhbFZhbHVlOiByb3cuYmxvY2tUeXBlLFxuICAgICAgICAgICAgICAgIHZhbGlkOiB0cnVlLFxuICAgICAgICAgICAgICAgIHZhbHVlOiByb3cuYmxvY2tUeXBlLFxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgc3RhdGVbYCR7cm93UGF0aH1ibG9ja05hbWVgXSA9IHtcbiAgICAgICAgICAgICAgICBpbml0aWFsVmFsdWU6IHJvdy5ibG9ja05hbWUsXG4gICAgICAgICAgICAgICAgdmFsaWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHJvdy5ibG9ja05hbWUsXG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBhY2MucHJvbWlzZXMucHVzaChcbiAgICAgICAgICAgICAgICBpdGVyYXRlRmllbGRzKHtcbiAgICAgICAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgICAgICAgY29uZmlnLFxuICAgICAgICAgICAgICAgICAgZGF0YTogcm93LFxuICAgICAgICAgICAgICAgICAgZmllbGRzOiBibG9jay5maWVsZHMsXG4gICAgICAgICAgICAgICAgICBmdWxsRGF0YSxcbiAgICAgICAgICAgICAgICAgIGxvY2FsZSxcbiAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbixcbiAgICAgICAgICAgICAgICAgIHBhcmVudFBhc3Nlc0NvbmRpdGlvbjogcGFzc2VzQ29uZGl0aW9uLFxuICAgICAgICAgICAgICAgICAgcGF0aDogcm93UGF0aCxcbiAgICAgICAgICAgICAgICAgIHByZWZlcmVuY2VzLFxuICAgICAgICAgICAgICAgICAgc3RhdGUsXG4gICAgICAgICAgICAgICAgICB0LFxuICAgICAgICAgICAgICAgICAgdXNlcixcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgKVxuXG4gICAgICAgICAgICAgIGNvbnN0IGNvbGxhcHNlZFJvd0lEcyA9IHByZWZlcmVuY2VzPy5maWVsZHM/LltgJHtwYXRofSR7ZmllbGQubmFtZX1gXT8uY29sbGFwc2VkXG5cbiAgICAgICAgICAgICAgYWNjLnJvd01ldGFkYXRhLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkOiByb3cuaWQsXG4gICAgICAgICAgICAgICAgYmxvY2tUeXBlOiByb3cuYmxvY2tUeXBlLFxuICAgICAgICAgICAgICAgIGNoaWxkRXJyb3JQYXRoczogbmV3IFNldCgpLFxuICAgICAgICAgICAgICAgIGNvbGxhcHNlZDpcbiAgICAgICAgICAgICAgICAgIGNvbGxhcHNlZFJvd0lEcyA9PT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgID8gZmllbGQuYWRtaW4uaW5pdENvbGxhcHNlZFxuICAgICAgICAgICAgICAgICAgICA6IGNvbGxhcHNlZFJvd0lEcy5pbmNsdWRlcyhyb3cuaWQpLFxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gYWNjXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBwcm9taXNlczogW10sXG4gICAgICAgICAgICByb3dNZXRhZGF0YTogW10sXG4gICAgICAgICAgfSxcbiAgICAgICAgKVxuXG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKVxuXG4gICAgICAgIC8vIEFkZCB2YWx1ZXMgdG8gZmllbGQgc3RhdGVcbiAgICAgICAgaWYgKHZhbHVlV2l0aERlZmF1bHQgPT09IG51bGwpIHtcbiAgICAgICAgICBmaWVsZFN0YXRlLnZhbHVlID0gbnVsbFxuICAgICAgICAgIGZpZWxkU3RhdGUuaW5pdGlhbFZhbHVlID0gbnVsbFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZpZWxkU3RhdGUudmFsdWUgPSBibG9ja3NWYWx1ZS5sZW5ndGhcbiAgICAgICAgICBmaWVsZFN0YXRlLmluaXRpYWxWYWx1ZSA9IGJsb2Nrc1ZhbHVlLmxlbmd0aFxuXG4gICAgICAgICAgaWYgKGJsb2Nrc1ZhbHVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZpZWxkU3RhdGUuZGlzYWJsZUZvcm1EYXRhID0gdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZpZWxkU3RhdGUucm93cyA9IHJvd01ldGFkYXRhXG5cbiAgICAgICAgLy8gQWRkIGZpZWxkIHRvIHN0YXRlXG4gICAgICAgIHN0YXRlW2Ake3BhdGh9JHtmaWVsZC5uYW1lfWBdID0gZmllbGRTdGF0ZVxuXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG5cbiAgICAgIGNhc2UgJ2dyb3VwJzoge1xuICAgICAgICBhd2FpdCBpdGVyYXRlRmllbGRzKHtcbiAgICAgICAgICBpZCxcbiAgICAgICAgICBjb25maWcsXG4gICAgICAgICAgZGF0YTogZGF0YT8uW2ZpZWxkLm5hbWVdIHx8IHt9LFxuICAgICAgICAgIGZpZWxkczogZmllbGQuZmllbGRzLFxuICAgICAgICAgIGZ1bGxEYXRhLFxuICAgICAgICAgIGxvY2FsZSxcbiAgICAgICAgICBvcGVyYXRpb24sXG4gICAgICAgICAgcGFyZW50UGFzc2VzQ29uZGl0aW9uOiBwYXNzZXNDb25kaXRpb24sXG4gICAgICAgICAgcGF0aDogYCR7cGF0aH0ke2ZpZWxkLm5hbWV9LmAsXG4gICAgICAgICAgcHJlZmVyZW5jZXMsXG4gICAgICAgICAgc3RhdGUsXG4gICAgICAgICAgdCxcbiAgICAgICAgICB1c2VyLFxuICAgICAgICB9KVxuXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG5cbiAgICAgIGNhc2UgJ3JlbGF0aW9uc2hpcCc6IHtcbiAgICAgICAgaWYgKGZpZWxkLmhhc01hbnkpIHtcbiAgICAgICAgICBjb25zdCByZWxhdGlvbnNoaXBWYWx1ZSA9IEFycmF5LmlzQXJyYXkodmFsdWVXaXRoRGVmYXVsdClcbiAgICAgICAgICAgID8gdmFsdWVXaXRoRGVmYXVsdC5tYXAoKHJlbGF0aW9uc2hpcCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGZpZWxkLnJlbGF0aW9uVG8pKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICByZWxhdGlvblRvOiByZWxhdGlvbnNoaXAucmVsYXRpb25UbyxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZW9mIHJlbGF0aW9uc2hpcC52YWx1ZSA9PT0gJ3N0cmluZydcbiAgICAgICAgICAgICAgICAgICAgICAgID8gcmVsYXRpb25zaGlwLnZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHJlbGF0aW9uc2hpcC52YWx1ZT8uaWQsXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVsYXRpb25zaGlwID09PSAnb2JqZWN0JyAmJiByZWxhdGlvbnNoaXAgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiByZWxhdGlvbnNoaXAuaWRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlbGF0aW9uc2hpcFxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgOiB1bmRlZmluZWRcblxuICAgICAgICAgIGZpZWxkU3RhdGUudmFsdWUgPSByZWxhdGlvbnNoaXBWYWx1ZVxuICAgICAgICAgIGZpZWxkU3RhdGUuaW5pdGlhbFZhbHVlID0gcmVsYXRpb25zaGlwVmFsdWVcbiAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGZpZWxkLnJlbGF0aW9uVG8pKSB7XG4gICAgICAgICAgaWYgKFxuICAgICAgICAgICAgdmFsdWVXaXRoRGVmYXVsdCAmJlxuICAgICAgICAgICAgdHlwZW9mIHZhbHVlV2l0aERlZmF1bHQgPT09ICdvYmplY3QnICYmXG4gICAgICAgICAgICAncmVsYXRpb25UbycgaW4gdmFsdWVXaXRoRGVmYXVsdCAmJlxuICAgICAgICAgICAgJ3ZhbHVlJyBpbiB2YWx1ZVdpdGhEZWZhdWx0XG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9XG4gICAgICAgICAgICAgIHR5cGVvZiB2YWx1ZVdpdGhEZWZhdWx0Py52YWx1ZSA9PT0gJ29iamVjdCcgJiZcbiAgICAgICAgICAgICAgdmFsdWVXaXRoRGVmYXVsdD8udmFsdWUgJiZcbiAgICAgICAgICAgICAgJ2lkJyBpbiB2YWx1ZVdpdGhEZWZhdWx0LnZhbHVlXG4gICAgICAgICAgICAgICAgPyB2YWx1ZVdpdGhEZWZhdWx0LnZhbHVlLmlkXG4gICAgICAgICAgICAgICAgOiB2YWx1ZVdpdGhEZWZhdWx0LnZhbHVlXG4gICAgICAgICAgICBjb25zdCByZWxhdGlvbnNoaXBWYWx1ZSA9IHtcbiAgICAgICAgICAgICAgcmVsYXRpb25UbzogdmFsdWVXaXRoRGVmYXVsdD8ucmVsYXRpb25UbyxcbiAgICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWVsZFN0YXRlLnZhbHVlID0gcmVsYXRpb25zaGlwVmFsdWVcbiAgICAgICAgICAgIGZpZWxkU3RhdGUuaW5pdGlhbFZhbHVlID0gcmVsYXRpb25zaGlwVmFsdWVcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3QgcmVsYXRpb25zaGlwVmFsdWUgPVxuICAgICAgICAgICAgdmFsdWVXaXRoRGVmYXVsdCAmJiB0eXBlb2YgdmFsdWVXaXRoRGVmYXVsdCA9PT0gJ29iamVjdCcgJiYgJ2lkJyBpbiB2YWx1ZVdpdGhEZWZhdWx0XG4gICAgICAgICAgICAgID8gdmFsdWVXaXRoRGVmYXVsdC5pZFxuICAgICAgICAgICAgICA6IHZhbHVlV2l0aERlZmF1bHRcbiAgICAgICAgICBmaWVsZFN0YXRlLnZhbHVlID0gcmVsYXRpb25zaGlwVmFsdWVcbiAgICAgICAgICBmaWVsZFN0YXRlLmluaXRpYWxWYWx1ZSA9IHJlbGF0aW9uc2hpcFZhbHVlXG4gICAgICAgIH1cblxuICAgICAgICBzdGF0ZVtgJHtwYXRofSR7ZmllbGQubmFtZX1gXSA9IGZpZWxkU3RhdGVcblxuICAgICAgICBicmVha1xuICAgICAgfVxuXG4gICAgICBjYXNlICd1cGxvYWQnOiB7XG4gICAgICAgIGNvbnN0IHJlbGF0aW9uc2hpcFZhbHVlID1cbiAgICAgICAgICB2YWx1ZVdpdGhEZWZhdWx0ICYmIHR5cGVvZiB2YWx1ZVdpdGhEZWZhdWx0ID09PSAnb2JqZWN0JyAmJiAnaWQnIGluIHZhbHVlV2l0aERlZmF1bHRcbiAgICAgICAgICAgID8gdmFsdWVXaXRoRGVmYXVsdC5pZFxuICAgICAgICAgICAgOiB2YWx1ZVdpdGhEZWZhdWx0XG4gICAgICAgIGZpZWxkU3RhdGUudmFsdWUgPSByZWxhdGlvbnNoaXBWYWx1ZVxuICAgICAgICBmaWVsZFN0YXRlLmluaXRpYWxWYWx1ZSA9IHJlbGF0aW9uc2hpcFZhbHVlXG5cbiAgICAgICAgc3RhdGVbYCR7cGF0aH0ke2ZpZWxkLm5hbWV9YF0gPSBmaWVsZFN0YXRlXG5cbiAgICAgICAgYnJlYWtcbiAgICAgIH1cblxuICAgICAgZGVmYXVsdDoge1xuICAgICAgICBmaWVsZFN0YXRlLnZhbHVlID0gdmFsdWVXaXRoRGVmYXVsdFxuICAgICAgICBmaWVsZFN0YXRlLmluaXRpYWxWYWx1ZSA9IHZhbHVlV2l0aERlZmF1bHRcblxuICAgICAgICAvLyBBZGQgZmllbGQgdG8gc3RhdGVcbiAgICAgICAgc3RhdGVbYCR7cGF0aH0ke2ZpZWxkLm5hbWV9YF0gPSBmaWVsZFN0YXRlXG5cbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSBpZiAoZmllbGRIYXNTdWJGaWVsZHMoZmllbGQpKSB7XG4gICAgLy8gSGFuZGxlIGZpZWxkIHR5cGVzIHRoYXQgZG8gbm90IHVzZSBuYW1lcyAocm93LCBldGMpXG4gICAgYXdhaXQgaXRlcmF0ZUZpZWxkcyh7XG4gICAgICBpZCxcbiAgICAgIGNvbmZpZyxcbiAgICAgIGRhdGEsXG4gICAgICBmaWVsZHM6IGZpZWxkLmZpZWxkcyxcbiAgICAgIGZ1bGxEYXRhLFxuICAgICAgbG9jYWxlLFxuICAgICAgb3BlcmF0aW9uLFxuICAgICAgcGFyZW50UGFzc2VzQ29uZGl0aW9uOiBwYXNzZXNDb25kaXRpb24sXG4gICAgICBwYXRoLFxuICAgICAgcHJlZmVyZW5jZXMsXG4gICAgICBzdGF0ZSxcbiAgICAgIHQsXG4gICAgICB1c2VyLFxuICAgIH0pXG4gIH0gZWxzZSBpZiAoZmllbGQudHlwZSA9PT0gJ3RhYnMnKSB7XG4gICAgY29uc3QgcHJvbWlzZXMgPSBmaWVsZC50YWJzLm1hcCgodGFiKSA9PlxuICAgICAgaXRlcmF0ZUZpZWxkcyh7XG4gICAgICAgIGlkLFxuICAgICAgICBjb25maWcsXG4gICAgICAgIGRhdGE6IHRhYkhhc05hbWUodGFiKSA/IGRhdGE/Llt0YWIubmFtZV0gOiBkYXRhLFxuICAgICAgICBmaWVsZHM6IHRhYi5maWVsZHMsXG4gICAgICAgIGZ1bGxEYXRhLFxuICAgICAgICBsb2NhbGUsXG4gICAgICAgIG9wZXJhdGlvbixcbiAgICAgICAgcGFyZW50UGFzc2VzQ29uZGl0aW9uOiBwYXNzZXNDb25kaXRpb24sXG4gICAgICAgIHBhdGg6IHRhYkhhc05hbWUodGFiKSA/IGAke3BhdGh9JHt0YWIubmFtZX0uYCA6IHBhdGgsXG4gICAgICAgIHByZWZlcmVuY2VzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgdCxcbiAgICAgICAgdXNlcixcbiAgICAgIH0pLFxuICAgIClcblxuICAgIGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKVxuICB9XG59XG4iXSwibmFtZXMiOlsiYWRkRmllbGRTdGF0ZVByb21pc2UiLCJpZCIsImNvbmZpZyIsImRhdGEiLCJmaWVsZCIsImZ1bGxEYXRhIiwibG9jYWxlIiwib3BlcmF0aW9uIiwicGFzc2VzQ29uZGl0aW9uIiwicGF0aCIsInByZWZlcmVuY2VzIiwic3RhdGUiLCJ0IiwidXNlciIsImZpZWxkQWZmZWN0c0RhdGEiLCJmaWVsZFN0YXRlIiwiY29uZGl0aW9uIiwiYWRtaW4iLCJpbml0aWFsVmFsdWUiLCJ1bmRlZmluZWQiLCJ2YWxpZCIsInZhbGlkYXRlIiwidmFsdWUiLCJ2YWx1ZVdpdGhEZWZhdWx0IiwiZ2V0VmFsdWVXaXRoRGVmYXVsdCIsImRlZmF1bHRWYWx1ZSIsIm5hbWUiLCJ2YWxpZGF0aW9uUmVzdWx0Iiwic2libGluZ0RhdGEiLCJlcnJvck1lc3NhZ2UiLCJ0eXBlIiwiYXJyYXlWYWx1ZSIsIkFycmF5IiwiaXNBcnJheSIsInByb21pc2VzIiwicm93TWV0YWRhdGEiLCJyZWR1Y2UiLCJhY2MiLCJyb3ciLCJpIiwicm93UGF0aCIsIk9iamVjdElEIiwidG9IZXhTdHJpbmciLCJwdXNoIiwiaXRlcmF0ZUZpZWxkcyIsImZpZWxkcyIsInBhcmVudFBhc3Nlc0NvbmRpdGlvbiIsImNvbGxhcHNlZFJvd0lEcyIsImNvbGxhcHNlZCIsImNoaWxkRXJyb3JQYXRocyIsIlNldCIsImluaXRDb2xsYXBzZWQiLCJpbmNsdWRlcyIsIlByb21pc2UiLCJhbGwiLCJsZW5ndGgiLCJkaXNhYmxlRm9ybURhdGEiLCJyb3dzIiwiYmxvY2tzVmFsdWUiLCJibG9jayIsImJsb2NrcyIsImZpbmQiLCJibG9ja1R5cGUiLCJzbHVnIiwiYmxvY2tOYW1lIiwiaGFzTWFueSIsInJlbGF0aW9uc2hpcFZhbHVlIiwibWFwIiwicmVsYXRpb25zaGlwIiwicmVsYXRpb25UbyIsImZpZWxkSGFzU3ViRmllbGRzIiwidGFicyIsInRhYiIsInRhYkhhc05hbWUiXSwibWFwcGluZ3MiOiJBQUFBLG9DQUFvQzs7OzsrQkFnQ3ZCQTs7O2VBQUFBOzs7cUVBN0JRO3VCQU8yQzt3RUFDaEM7K0JBQ0Y7Ozs7OztBQW9CdkIsTUFBTUEsdUJBQXVCLE9BQU8sRUFDekNDLEVBQUUsRUFDRkMsTUFBTSxFQUNOQyxJQUFJLEVBQ0pDLEtBQUssRUFDTEMsUUFBUSxFQUNSQyxNQUFNLEVBQ05DLFNBQVMsRUFDVEMsZUFBZSxFQUNmQyxJQUFJLEVBQ0pDLFdBQVcsRUFDWEMsS0FBSyxFQUNMQyxDQUFDLEVBQ0RDLElBQUksRUFDQztJQUNMLElBQUlDLElBQUFBLHVCQUFnQixFQUFDVixRQUFRO1FBQzNCLE1BQU1XLGFBQXdCO1lBQzVCQyxXQUFXWixNQUFNYSxLQUFLLEVBQUVEO1lBQ3hCRSxjQUFjQztZQUNkWDtZQUNBWSxPQUFPO1lBQ1BDLFVBQVVqQixNQUFNaUIsUUFBUTtZQUN4QkMsT0FBT0g7UUFDVDtRQUVBLE1BQU1JLG1CQUFtQixNQUFNQyxJQUFBQSx3QkFBbUIsRUFBQztZQUNqREMsY0FBY3JCLE1BQU1xQixZQUFZO1lBQ2hDbkI7WUFDQU87WUFDQVMsT0FBT25CLE1BQU0sQ0FBQ0MsTUFBTXNCLElBQUksQ0FBQztRQUMzQjtRQUVBLElBQUl2QixNQUFNLENBQUNDLE1BQU1zQixJQUFJLENBQUMsRUFBRTtZ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