"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return _default;
    }
});
const reducer = (state, action)=>{
    const newState = [
        ...state
    ];
    const { andIndex, orIndex } = action;
    switch(action.type){
        case 'add':
            {
                const { field, relation } = action;
                if (relation === 'and') {
                    newState[orIndex].and.splice(andIndex, 0, {
                        [field]: {}
                    });
                    return newState;
                }
                return [
                    ...newState,
                    {
                        and: [
                            {
                                [field]: {}
                            }
                        ]
                    }
                ];
            }
        case 'remove':
            {
                newState[orIndex].and.splice(andIndex, 1);
                if (newState[orIndex].and.length === 0) {
                    newState.splice(orIndex, 1);
                }
                return newState;
            }
        case 'update':
            {
                const { field, operator, value } = action;
                if (typeof newState[orIndex].and[andIndex] === 'object') {
                    newState[orIndex].and[andIndex] = {
                        ...newState[orIndex].and[andIndex]
                    };
                    const [existingFieldName, existingCondition] = Object.entries(newState[orIndex].and[andIndex])[0] || [
                        undefined,
                        undefined
                    ];
                    if (operator) {
                        newState[orIndex].and[andIndex] = {
                            [existingFieldName]: {
                                [operator]: Object.values(existingCondition)[0]
                            }
                        };
                    }
                    if (field) {
                        newState[orIndex].and[andIndex] = {
                            [field]: {
                                [Object.keys(existingCondition)[0]]: Object.values(existingCondition)[0]
                            }
                        };
                    }
                    if (value !== undefined) {
                        newState[orIndex].and[andIndex] = {
                            [existingFieldName]: {
                                [Object.keys(existingCondition)[0]]: value
                            }
                        };
                    }
                }
                return newState;
            }
        default:
            {
                return newState;
            }
    }
};
const _default = reducer;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9hZG1pbi9jb21wb25lbnRzL2VsZW1lbnRzL1doZXJlQnVpbGRlci9yZWR1Y2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgV2hlcmUgfSBmcm9tICcuLi8uLi8uLi8uLi90eXBlcydcbmltcG9ydCB0eXBlIHsgQWN0aW9uIH0gZnJvbSAnLi90eXBlcydcblxuY29uc3QgcmVkdWNlciA9IChzdGF0ZTogV2hlcmVbXSwgYWN0aW9uOiBBY3Rpb24pOiBXaGVyZVtdID0+IHtcbiAgY29uc3QgbmV3U3RhdGUgPSBbLi4uc3RhdGVdXG5cbiAgY29uc3QgeyBhbmRJbmRleCwgb3JJbmRleCB9ID0gYWN0aW9uXG5cbiAgc3dpdGNoIChhY3Rpb24udHlwZSkge1xuICAgIGNhc2UgJ2FkZCc6IHtcbiAgICAgIGNvbnN0IHsgZmllbGQsIHJlbGF0aW9uIH0gPSBhY3Rpb25cblxuICAgICAgaWYgKHJlbGF0aW9uID09PSAnYW5kJykge1xuICAgICAgICBuZXdTdGF0ZVtvckluZGV4XS5hbmQuc3BsaWNlKGFuZEluZGV4LCAwLCB7IFtmaWVsZF06IHt9IH0pXG4gICAgICAgIHJldHVybiBuZXdTdGF0ZVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gW1xuICAgICAgICAuLi5uZXdTdGF0ZSxcbiAgICAgICAge1xuICAgICAgICAgIGFuZDogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBbZmllbGRdOiB7fSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgIF1cbiAgICB9XG5cbiAgICBjYXNlICdyZW1vdmUnOiB7XG4gICAgICBuZXdTdGF0ZVtvckluZGV4XS5hbmQuc3BsaWNlKGFuZEluZGV4LCAxKVxuXG4gICAgICBpZiAobmV3U3RhdGVbb3JJbmRleF0uYW5kLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBuZXdTdGF0ZS5zcGxpY2Uob3JJbmRleCwgMSlcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG5ld1N0YXRlXG4gICAgfVxuXG4gICAgY2FzZSAndXBkYXRlJzoge1xuICAgICAgY29uc3QgeyBmaWVsZCwgb3BlcmF0b3IsIHZhbHVlIH0gPSBhY3Rpb25cblxuICAgICAgaWYgKHR5cGVvZiBuZXdTdGF0ZVtvckluZGV4XS5hbmRbYW5kSW5kZXhdID09PSAnb2JqZWN0Jykge1xuICAgICAgICBuZXdTdGF0ZVtvckluZGV4XS5hbmRbYW5kSW5kZXhdID0ge1xuICAgICAgICAgIC4uLm5ld1N0YXRlW29ySW5kZXhdLmFuZFthbmRJbmRleF0sXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBbZXhpc3RpbmdGaWVsZE5hbWUsIGV4aXN0aW5nQ29uZGl0aW9uXSA9IE9iamVjdC5lbnRyaWVzKFxuICAgICAgICAgIG5ld1N0YXRlW29ySW5kZXhdLmFuZFthbmRJbmRleF0sXG4gICAgICAgIClbMF0gfHwgW3VuZGVmaW5lZCwgdW5kZWZpbmVkXVxuXG4gICAgICAgIGlmIChvcGVyYXRvcikge1xuICAgICAgICAgIG5ld1N0YXRlW29ySW5kZXhdLmFuZFthbmRJbmRleF0gPSB7XG4gICAgICAgICAgICBbZXhpc3RpbmdGaWVsZE5hbWVdOiB7XG4gICAgICAgICAgICAgIFtvcGVyYXRvcl06IE9iamVjdC52YWx1ZXMoZXhpc3RpbmdDb25kaXRpb24pWzBdLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICBuZXdTdGF0ZVtvckluZGV4XS5hbmRbYW5kSW5kZXhdID0ge1xuICAgICAgICAgICAgW2ZpZWxkXToge1xuICAgICAgICAgICAgICBbT2JqZWN0LmtleXMoZXhpc3RpbmdDb25kaXRpb24pWzBdXTogT2JqZWN0LnZhbHVlcyhleGlzdGluZ0NvbmRpdGlvbilbMF0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgbmV3U3RhdGVbb3JJbmRleF0uYW5kW2FuZEluZGV4XSA9IHtcbiAgICAgICAgICAgIFtleGlzdGluZ0ZpZWxkTmFtZV06IHtcbiAgICAgICAgICAgICAgW09iamVjdC5rZXlzKGV4aXN0aW5nQ29uZGl0aW9uKVswXV06IHZhbHVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG5ld1N0YXRlXG4gICAgfVxuXG4gICAgZGVmYXVsdDoge1xuICAgICAgcmV0dXJuIG5ld1N0YXRlXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IHJlZHVjZXJcbiJdLCJuYW1lcyI6WyJyZWR1Y2VyIiwic3RhdGUiLCJhY3Rpb24iLCJuZXdTdGF0ZSIsImFuZEluZGV4Iiwib3JJbmRleCIsInR5cGUiLCJmaWVsZCIsInJlbGF0aW9uIiwiYW5kIiwic3BsaWNlIiwibGVuZ3RoIiwib3BlcmF0b3IiLCJ2YWx1ZSIsImV4aXN0aW5nRmllbGROYW1lIiwiZXhpc3RpbmdDb25kaXRpb24iLCJPYmplY3QiLCJlbnRyaWVzIiwidW5kZWZpbmVkIiwidmFsdWVzIiwia2V5cyJdLCJtYXBwaW5ncyI6Ijs7OzsrQkFxRkE7OztlQUFBOzs7QUFsRkEsTUFBTUEsVUFBVSxDQUFDQyxPQUFnQkM7SUFDL0IsTUFBTUMsV0FBVztXQUFJRjtLQUFNO0lBRTNCLE1BQU0sRUFBRUcsUUFBUSxFQUFFQyxPQUFPLEVBQUUsR0FBR0g7SUFFOUIsT0FBUUEsT0FBT0ksSUFBSTtRQUNqQixLQUFLO1lBQU87Z0JBQ1YsTUFBTSxFQUFFQyxLQUFLLEVBQUVDLFFBQVEsRUFBRSxHQUFHTjtnQkFFNUIsSUFBSU0sYUFBYSxPQUFPO29CQUN0QkwsUUFBUSxDQUFDRSxRQUFRLENBQUNJLEdBQUcsQ0FBQ0MsTUFBTSxDQUFDTixVQUFVLEdBQUc7d0JBQUUsQ0FBQ0csTUFBTSxFQUFFLENBQUM7b0JBQUU7b0JBQ3hELE9BQU9KO2dCQUNUO2dCQUVBLE9BQU87dUJBQ0ZBO29CQUNIO3dCQUNFTSxLQUFLOzRCQUNIO2dDQUNFLENBQUNGLE1BQU0sRUFBRSxDQUFDOzRCQUNaO3lCQUNEO29CQUNIO2lCQUNEO1lBQ0g7UUFFQSxLQUFLO1lBQVU7Z0JBQ2JKLFFBQVEsQ0FBQ0UsUUFBUSxDQUFDSSxHQUFHLENBQUNDLE1BQU0sQ0FBQ04sVUFBVTtnQkFFdkMsSUFBSUQsUUFBUSxDQUFDRSxRQUFRLENBQUNJLEdBQUcsQ0FBQ0UsTUFBTSxLQUFLLEdBQUc7b0JBQ3RDUixTQUFTTyxNQUFNLENBQUNMLFNBQVM7Z0JBQzNCO2dCQUVBLE9BQU9GO1lBQ1Q7UUFFQSxLQUFLO1lBQVU7Z0JBQ2IsTUFBTSxFQUFFSSxLQUFLLEVBQUVLLFFBQVEsRUFBRUMsS0FBSyxFQUFFLEdBQUdYO2dCQUVuQyxJQUFJLE9BQU9DLFFBQVEsQ0FBQ0UsUUFBUSxDQUFDSSxHQUFHLENBQUNMLFNBQVMsS0FBSyxVQUFVO29CQUN2REQsUUFBUSxDQUFDRSxRQUFRLENBQUNJLEdBQUcsQ0FBQ0wsU0FBUyxHQUFHO3dCQUNoQyxHQUFHRCxRQUFRLENBQUNFLFFBQVEsQ0FBQ0ksR0FBRyxDQUFDTCxTQUFTO29CQUNwQztvQkFFQSxNQUFNLENBQUNVLG1CQUFtQkMsa0JBQWtCLEdBQUdDLE9BQU9DLE9BQU8sQ0FDM0RkLFFBQVEsQ0FBQ0UsUUFBUSxDQUFDSSxHQUFHLENBQUNMLFNBQVMsQ0FDaEMsQ0FBQyxFQUFFLElBQUk7d0JBQUNjO3dCQUFXQTtxQkFBVTtvQkFFOUIsSUFBSU4sVUFBVTt3QkFDWlQsUUFBUSxDQUFDRSxRQUFRLENBQUNJLEdBQUcsQ0FBQ0wsU0FBUyxHQUFHOzRCQUNoQyxDQUFDVSxrQkFBa0IsRUFBRTtnQ0FDbkIsQ0FBQ0YsU0FBUyxFQUFFSSxPQUFPRyxNQUFNLENBQUNKLGtCQUFrQixDQUFDLEVBQUU7NEJBQ2pEO3dCQUNGO29CQUNGO29CQUVBLElBQUlSLE9BQU87d0JBQ1RKLFFBQVEsQ0FBQ0UsUUFBUSxDQUFDSSxHQUFHLENBQUNMLFNBQVMsR0FBRzs0QkFDaEMsQ0FBQ0csTUFBTSxFQUFFO2dDQUNQLENBQUNTLE9BQU9JLElBQUksQ0FBQ0wsa0JBQWtCLENBQUMsRUFBRSxDQUFDLEVBQUVDLE9BQU9HLE1BQU0sQ0FBQ0osa0JBQWtCLENBQUMsRUFBRTs0QkFDMUU7d0JBQ0Y7b0JBQ0Y7b0JBRUEsSUFBSUYsVUFBVUssV0FBVzt3QkFDdkJmLFFBQVEsQ0FBQ0UsUUFBUSxDQUFDSSxHQUFHLENBQUNMLFNBQVMsR0FBRzs0QkFDaEMsQ0FBQ1Usa0JBQWtCLEVBQUU7Z0NBQ25CLENBQUNFLE9BQU9JLElBQUksQ0FBQ0wsa0JBQWtCLENBQUMsRUFBRSxDQUFDLEVBQUVGOzRCQUN2Qzt3QkFDRjtvQkFDRjtnQkFDRjtnQkFFQSxPQUFPVjtZQUNUO1FBRUE7WUFBUztnQkFDUCxPQUFPQTtZQUNUO0lBQ0Y7QUFDRjtNQUVBLFdBQWVIIn0=