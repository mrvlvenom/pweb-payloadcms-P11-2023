"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return _default;
    }
});
const _react = /*#__PURE__*/ _interop_require_wildcard(require("react"));
const _Meta = /*#__PURE__*/ _interop_require_default(require("../FileDetails/Meta"));
require("./index.scss");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {};
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
const baseClass = 'preview-sizes';
const sortSizes = (sizes, imageSizes)=>{
    if (!imageSizes || imageSizes.length === 0) return sizes;
    const orderedSizes = {};
    imageSizes.forEach(({ name })=>{
        if (sizes[name]) {
            orderedSizes[name] = sizes[name];
        }
    });
    return orderedSizes;
};
const PreviewSizes = ({ collection, doc, imageCacheTag })=>{
    const { upload: { imageSizes, staticURL } } = collection;
    const { sizes } = doc;
    const [orderedSizes, setOrderedSizes] = (0, _react.useState)(()=>sortSizes(sizes, imageSizes));
    const [selectedSize, setSelectedSize] = (0, _react.useState)(orderedSizes?.[imageSizes[0]?.name]?.filename ? imageSizes[0]?.name : null);
    const generateImageUrl = (filename)=>{
        return `${staticURL}/${filename}${imageCacheTag ? `?${imageCacheTag}` : ''}`;
    };
    (0, _react.useEffect)(()=>{
        setOrderedSizes(sortSizes(sizes, imageSizes));
    }, [
        sizes,
        imageSizes,
        imageCacheTag
    ]);
    const mainPreviewSrc = generateImageUrl(`${orderedSizes[selectedSize]?.filename}`);
    return /*#__PURE__*/ _react.default.createElement("div", {
        className: baseClass
    }, /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__imageWrap`
    }, /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__meta`
    }, /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__sizeName`
    }, selectedSize), /*#__PURE__*/ _react.default.createElement(_Meta.default, {
        ...selectedSize && orderedSizes[selectedSize],
        staticURL: staticURL
    })), /*#__PURE__*/ _react.default.createElement("img", {
        alt: doc.filename,
        className: `${baseClass}__preview`,
        src: mainPreviewSrc
    })), /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__listWrap`
    }, /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__list`
    }, Object.entries(orderedSizes).map(([key, val])=>{
        const selected = selectedSize === key;
        const previewSrc = generateImageUrl(val.filename);
        if (previewSrc) {
            return /*#__PURE__*/ _react.default.createElement("div", {
                className: [
                    `${baseClass}__sizeOption`,
                    selected && `${baseClass}--selected`
                ].filter(Boolean).join(' '),
                key: key,
                onClick: ()=>setSelectedSize(key),
                onKeyDown: (e)=>{
                    if (e.keyCode === 13) {
                        setSelectedSize(key);
                    }
                },
                role: "button",
                tabIndex: 0
            }, /*#__PURE__*/ _react.default.createElement("div", {
                className: `${baseClass}__image`
            }, /*#__PURE__*/ _react.default.createElement("img", {
                alt: val.filename,
                src: previewSrc
            })), /*#__PURE__*/ _react.default.createElement("div", {
                className: `${baseClass}__sizeMeta`
            }, /*#__PURE__*/ _react.default.createElement("div", {
                className: `${baseClass}__sizeName`
            }, key), /*#__PURE__*/ _react.default.createElement(_Meta.default, {
                ...val,
                staticURL: staticURL
            })));
        }
        return null;
    }))));
};
const _default = PreviewSizes;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9hZG1pbi9jb21wb25lbnRzL2VsZW1lbnRzL1ByZXZpZXdTaXplcy9pbmRleC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCdcblxuaW1wb3J0IHR5cGUgeyBTYW5pdGl6ZWRDb2xsZWN0aW9uQ29uZmlnIH0gZnJvbSAnLi4vLi4vLi4vLi4vZXhwb3J0cy90eXBlcydcbmltcG9ydCB0eXBlIHsgRmlsZVNpemVzLCBVcGxvYWQgfSBmcm9tICcuLi8uLi8uLi8uLi91cGxvYWRzL3R5cGVzJ1xuaW1wb3J0IHR5cGUgeyBEYXRhIH0gZnJvbSAnLi4vLi4vZm9ybXMvRm9ybS90eXBlcydcblxuaW1wb3J0IE1ldGEgZnJvbSAnLi4vRmlsZURldGFpbHMvTWV0YSdcbmltcG9ydCAnLi9pbmRleC5zY3NzJ1xuXG5jb25zdCBiYXNlQ2xhc3MgPSAncHJldmlldy1zaXplcydcblxuY29uc3Qgc29ydFNpemVzID0gKHNpemVzOiBGaWxlU2l6ZXMsIGltYWdlU2l6ZXM6IFVwbG9hZFsnaW1hZ2VTaXplcyddKSA9PiB7XG4gIGlmICghaW1hZ2VTaXplcyB8fCBpbWFnZVNpemVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHNpemVzXG5cbiAgY29uc3Qgb3JkZXJlZFNpemVzOiBGaWxlU2l6ZXMgPSB7fVxuXG4gIGltYWdlU2l6ZXMuZm9yRWFjaCgoeyBuYW1lIH0pID0+IHtcbiAgICBpZiAoc2l6ZXNbbmFtZV0pIHtcbiAgICAgIG9yZGVyZWRTaXplc1tuYW1lXSA9IHNpemVzW25hbWVdXG4gICAgfVxuICB9KVxuXG4gIHJldHVybiBvcmRlcmVkU2l6ZXNcbn1cblxuY29uc3QgUHJldmlld1NpemVzOiBSZWFjdC5GQzx7XG4gIGNvbGxlY3Rpb246IFNhbml0aXplZENvbGxlY3Rpb25Db25maWdcbiAgZG9jPzogRGF0YSAmIHtcbiAgICBzaXplcz86IEZpbGVTaXplc1xuICB9XG4gIGltYWdlQ2FjaGVUYWc/OiBzdHJpbmdcbn0+ID0gKHsgY29sbGVjdGlvbiwgZG9jLCBpbWFnZUNhY2hlVGFnIH0pID0+IHtcbiAgY29uc3Qge1xuICAgIHVwbG9hZDogeyBpbWFnZVNpemVzLCBzdGF0aWNVUkwgfSxcbiAgfSA9IGNvbGxlY3Rpb25cbiAgY29uc3QgeyBzaXplcyB9ID0gZG9jXG5cbiAgY29uc3QgW29yZGVyZWRTaXplcywgc2V0T3JkZXJlZFNpemVzXSA9IHVzZVN0YXRlPEZpbGVTaXplcz4oKCkgPT4gc29ydFNpemVzKHNpemVzLCBpbWFnZVNpemVzKSlcbiAgY29uc3QgW3NlbGVjdGVkU2l6ZSwgc2V0U2VsZWN0ZWRTaXplXSA9IHVzZVN0YXRlPG51bGwgfCBzdHJpbmc+KFxuICAgIG9yZGVyZWRTaXplcz8uW2ltYWdlU2l6ZXNbMF0/Lm5hbWVdPy5maWxlbmFtZSA/IGltYWdlU2l6ZXNbMF0/Lm5hbWUgOiBudWxsLFxuICApXG5cbiAgY29uc3QgZ2VuZXJhdGVJbWFnZVVybCA9IChmaWxlbmFtZSkgPT4ge1xuICAgIHJldHVybiBgJHtzdGF0aWNVUkx9LyR7ZmlsZW5hbWV9JHtpbWFnZUNhY2hlVGFnID8gYD8ke2ltYWdlQ2FjaGVUYWd9YCA6ICcnfWBcbiAgfVxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHNldE9yZGVyZWRTaXplcyhzb3J0U2l6ZXMoc2l6ZXMsIGltYWdlU2l6ZXMpKVxuICB9LCBbc2l6ZXMsIGltYWdlU2l6ZXMsIGltYWdlQ2FjaGVUYWddKVxuXG4gIGNvbnN0IG1haW5QcmV2aWV3U3JjID0gZ2VuZXJhdGVJbWFnZVVybChgJHtvcmRlcmVkU2l6ZXNbc2VsZWN0ZWRTaXplXT8uZmlsZW5hbWV9YClcblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPXtiYXNlQ2xhc3N9PlxuICAgICAgPGRpdiBjbGFzc05hbWU9e2Ake2Jhc2VDbGFzc31fX2ltYWdlV3JhcGB9PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YCR7YmFzZUNsYXNzfV9fbWV0YWB9PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtgJHtiYXNlQ2xhc3N9X19zaXplTmFtZWB9PntzZWxlY3RlZFNpemV9PC9kaXY+XG4gICAgICAgICAgPE1ldGEgey4uLihzZWxlY3RlZFNpemUgJiYgb3JkZXJlZFNpemVzW3NlbGVjdGVkU2l6ZV0pfSBzdGF0aWNVUkw9e3N0YXRpY1VSTH0gLz5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxpbWcgYWx0PXtkb2MuZmlsZW5hbWV9IGNsYXNzTmFtZT17YCR7YmFzZUNsYXNzfV9fcHJldmlld2B9IHNyYz17bWFpblByZXZpZXdTcmN9IC8+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtgJHtiYXNlQ2xhc3N9X19saXN0V3JhcGB9PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YCR7YmFzZUNsYXNzfV9fbGlzdGB9PlxuICAgICAgICAgIHtPYmplY3QuZW50cmllcyhvcmRlcmVkU2l6ZXMpLm1hcCgoW2tleSwgdmFsXSkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBzZWxlY3RlZFNpemUgPT09IGtleVxuICAgICAgICAgICAgY29uc3QgcHJldmlld1NyYyA9IGdlbmVyYXRlSW1hZ2VVcmwodmFsLmZpbGVuYW1lKVxuXG4gICAgICAgICAgICBpZiAocHJldmlld1NyYykge1xuICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17W2Ake2Jhc2VDbGFzc31fX3NpemVPcHRpb25gLCBzZWxlY3RlZCAmJiBgJHtiYXNlQ2xhc3N9LS1zZWxlY3RlZGBdXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAgICAgICAgICAgICAgICAgLmpvaW4oJyAnKX1cbiAgICAgICAgICAgICAgICAgIGtleT17a2V5fVxuICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0U2VsZWN0ZWRTaXplKGtleSl9XG4gICAgICAgICAgICAgICAgICBvbktleURvd249eyhlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT09IDEzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgc2V0U2VsZWN0ZWRTaXplKGtleSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgIHJvbGU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9ezB9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2Ake2Jhc2VDbGFzc31fX2ltYWdlYH0+XG4gICAgICAgICAgICAgICAgICAgIDxpbWcgYWx0PXt2YWwuZmlsZW5hbWV9IHNyYz17cHJldmlld1NyY30gLz5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2Ake2Jhc2VDbGFzc31fX3NpemVNZXRhYH0+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtgJHtiYXNlQ2xhc3N9X19zaXplTmFtZWB9PntrZXl9PC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxNZXRhIHsuLi52YWx9IHN0YXRpY1VSTD17c3RhdGljVVJMfSAvPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgICAgICB9KX1cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgKVxufVxuZXhwb3J0IGRlZmF1bHQgUHJldmlld1NpemVzXG4iXSwibmFtZXMiOlsiYmFzZUNsYXNzIiwic29ydFNpemVzIiwic2l6ZXMiLCJpbWFnZVNpemVzIiwibGVuZ3RoIiwib3JkZXJlZFNpemVzIiwiZm9yRWFjaCIsIm5hbWUiLCJQcmV2aWV3U2l6ZXMiLCJjb2xsZWN0aW9uIiwiZG9jIiwiaW1hZ2VDYWNoZVRhZyIsInVwbG9hZCIsInN0YXRpY1VSTCIsInNldE9yZGVyZWRTaXplcyIsInVzZVN0YXRlIiwic2VsZWN0ZWRTaXplIiwic2V0U2VsZWN0ZWRTaXplIiwiZmlsZW5hbWUiLCJnZW5lcmF0ZUltYWdlVXJsIiwidXNlRWZmZWN0IiwibWFpblByZXZpZXdTcmMiLCJkaXYiLCJjbGFzc05hbWUiLCJNZXRhIiwiaW1nIiwiYWx0Iiwic3JjIiwiT2JqZWN0IiwiZW50cmllcyIsIm1hcCIsImtleSIsInZhbCIsInNlbGVjdGVkIiwicHJldmlld1NyYyIsImZpbHRlciIsIkJvb2xlYW4iLCJqb2luIiwib25DbGljayIsIm9uS2V5RG93biIsImUiLCJrZXlDb2RlIiwicm9sZSIsInRhYkluZGV4Il0sIm1hcHBpbmdzIjoiOzs7OytCQW9HQTs7O2VBQUE7OzsrREFwRzJDOzZEQU0xQjtRQUNWOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFUCxNQUFNQSxZQUFZO0FBRWxCLE1BQU1DLFlBQVksQ0FBQ0MsT0FBa0JDO0lBQ25DLElBQUksQ0FBQ0EsY0FBY0EsV0FBV0MsTUFBTSxLQUFLLEdBQUcsT0FBT0Y7SUFFbkQsTUFBTUcsZUFBMEIsQ0FBQztJQUVqQ0YsV0FBV0csT0FBTyxDQUFDLENBQUMsRUFBRUMsSUFBSSxFQUFFO1FBQzFCLElBQUlMLEtBQUssQ0FBQ0ssS0FBSyxFQUFFO1lBQ2ZGLFlBQVksQ0FBQ0UsS0FBSyxHQUFHTCxLQUFLLENBQUNLLEtBQUs7UUFDbEM7SUFDRjtJQUVBLE9BQU9GO0FBQ1Q7QUFFQSxNQUFNRyxlQU1ELENBQUMsRUFBRUMsVUFBVSxFQUFFQyxHQUFHLEVBQUVDLGFBQWEsRUFBRTtJQUN0QyxNQUFNLEVBQ0pDLFFBQVEsRUFBRVQsVUFBVSxFQUFFVSxTQUFTLEVBQUUsRUFDbEMsR0FBR0o7SUFDSixNQUFNLEVBQUVQLEtBQUss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